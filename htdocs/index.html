<!DOCTYPE html>
<html lang="en">
<head>
 <title>NIMBY BINGO! The game that's sweeping your neighborhood meeting!</title>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <meta name="description" content="nimbingo, nimby bingo for Portland neighborhood association meetings">
  <meta name="author" content="twitter @tedder42">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- <link rel="icon" type="image/png" href="favicon.ico"> -->
  <script src="https://code.jquery.com/jquery-3.1.0.slim.min.js" integrity="sha256-cRpWjoSOw5KcyIOaZNo4i6fZ9tKPhYYb6i5T9RSVJG8=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="skeleton-plus.css">

  <!-- site verification(s) -->
  <meta name="google-site-verification" content="" />

  <style type="text/css">
  img.h100 { height: 10rem; max-width: auto }
  img.h200 { height: 20rem; max-width: auto }
  ul li { font-size: smaller; margin-top: 0.5rem; margin-bottom: 0; margin-left: 1.5rem }
  a { text-decoration: none }
  //div.row { margin-bottom: 1.5rem }
  .bingocard { border: 0; border-collapse: collapse; }
  .bingocard .bingorow { height: 14vw; background-color: #fff }
  .bingocard .bingocell { border: 0.4rem solid black; text-align: center; vertical-align: middle; width: 14vw; height: 14vw; padding: 0.4rem }
  .bingocell h2 { font-weight: 600; }
  .bingocell + .freesquare { background-color: #EEE; }
  #row0 .bingocell { background-color: #DDD; }
  input #newcard { color: #00f; }
  .newcard { vertical-align: bottom; }
  .newcard > #newcard { }
  .daub { background-color:#ff6666 !important; -webkit-border-radius:100%; -moz-border-radius:100%; border-radius:100%; border:40% solid transparent; }
  .addcards {font-size:0.75rem}
  span { font-size: 1.3rem; }
  </style>
  <style type="text/css" media="print">
    @page {
      size: 216mm 279mm;
      margin: 15mm;
      margin-right: 15mm;
    }
    table.bingocard
    {
      table-layout: fixed !important;
      page-break-before: always !important;
      page-break-inside: never !important;
      font-size:14pt;
    }
    div { float: none !important; position: static !important; display: inline; 
          box-sizing: content-box !important;
    }
    .bingocard .bingorow { height: 25mm; background-color: #fff }
    .bingocard .bingocell { border: 1mm solid black; text-align: center; vertical-align: middle; width: 25mm; height: 25mm; padding: 1mm }
  </style>
  <script type="text/javascript">

var phrases = //__PHRASES__

; // close the magically-inserted JSON

function generateCard() {
  //console.log("hellow orld");
  var ourlist = phrases['generics'].slice(); // slice copies array
  var chosen_city = $("input[name=city]").val() || 'Portland';
  var chosen_city_normalized = chosen_city.toLowerCase().replace(/\s+/g, '');
  console.log("city: ", chosen_city, chosen_city_normalized);
  if (phrases['locals'][chosen_city_normalized]) {
    locallist = phrases['locals'][chosen_city_normalized].slice(); // again, copy
    ourlist = $.merge(ourlist, locallist);
    //console.log(ourlist);
  }

  console.log("---", $(ourlist).length);
  //$(".bingocell").not(".populated").each(function() {
  // iterate over each card
  $(".bingocard").each(function() {
    //console.log("bingo card, yo", this);
    // new full array for each card; this copies it.
    var cardlist = ourlist.slice(0);

    // iterate over each cell in each card
    $(this).find(".bingocell").each(function() {
      if ( $.inArray('bingohead', $(this).attr('class').split(' ')) == -1
       &&  $.inArray('freesquare', $(this).attr('class').split(' ')) == -1) {
        //console.log($(this).attr('class'));
        var i = Math.floor(Math.random()*cardlist.length);
        var itext = cardlist.splice(i, 1)[0];
        //console.log(i, $(cardlist).length, itext);
        //console.log("it", itext);
        $(this).html(itext.replace('$CITY', chosen_city));
        $(this).addClass('populated')
      }
    });
  });
}

function dump_phrases() {
  var txt = '<br /><br /><p><b>please read through the following phrases before submitting new ones</b>, then <a href="https://twitter.com/tedder42">hit tedder up on twitter</a> with your generic or city-specific phrases. the nerds can also <a href="https://github.com/tedder/nimbingo/">fork and submit a pull request</a>.</p><pre>' + phrases['generics'].slice().join(',\n');
  $.each(phrases['locals'], function(i,j) {
    txt += '\n\n** ' + i + '\n  ' + j.join(',\n  ');
    console.log(i,j);
  });

  txt += '<\/pre>';
  $('#phraselist').replaceWith(txt);
}

function loadDauber(){
  $('td.bingocell').off('click');
  $('td.bingocell').click(function(){
    $(this).toggleClass('daub');
  });
}

function loadCloner(contents){
  $('.add_cards').click(function(){
    cloneCard(contents,$(this).attr('data-card_count'));
  });
}
function cloneCard(contents,count){
  for(var i=0; i < count; i++){
    $('#main_container').append(contents.clone());
    generateCard();
  }
  loadDauber();
}

function init() {
  var blankCard = $('table.bingocard').clone()
  generateCard();
  loadCloner(blankCard);
  loadDauber();
  $("input[name=city]").val('Portland');
  $('input[name=city]').focusin(function() {
    $(this).val('');
  });
  $('#phraseclick').click(dump_phrases);
}

$(document).ready(init);

  </script>
</head>
<body>
<div class="container" id="main_container">
 <div class="row" style="margin-bottom: 2em">
  <div class="ten columns"><h2 style="margin: 0; padding: 0">nimbingo, nimby bingo!</h2>the fun game you can play at your neighborhood meeting. fill it in when you hear the term, or use them in conversation until you get bingo. blame <a href="https://twitter.com/adamherstein">adam</a> <a href="https://twitter.com/alankesslr">alan</a> and <a href="https://twitter.com/tedder42">tedder</a> for this; <span id="phraselist"><a id="phraseclick">suggest new phrases/cities</a>.</span></div>
  <div class="two columns newcard">
<input list="cities" name="city">
<datalist id="cities">
  <option value="Boulder">
  <option value="Minneapolis">
  <option value="Portland">
  <option value="Richmond">
  <option value="San Francisco">
  <option value="Vancouver">
</datalist>
<div class="addcards">
  Add:
  <a href="#" data-remote="true" class="add_cards" data-card_count="1">1</a>
  <a href="#" data-remote="true" class="add_cards" data-card_count="10">10</a>
  <a href="#" data-remote="true" class="add_cards" data-card_count="100">100</a>
cards
</div>
<input id="newcard" type="button" value="generate new card" onClick="generateCard()"></div>
 </div> <!-- row -->
 <div class="row">
  <div class="twelve columns columns-sm bingocard">

 <table border=2 class="bingocard">
  <tr id="row0">
   <th class="bingocell bingohead"><h2>N</h2></th>
   <th class="bingocell bingohead"><h2>I</h2></th>
   <th class="bingocell bingohead"><h2>M</h2></th>
   <th class="bingocell bingohead"><h2>B</h2></th>
   <th class="bingocell bingohead"><h2>Y</h2></th>
  </tr>
  <tr>
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
  </tr>
  <tr>
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
  </tr>
  <tr>
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell freesquare"><b>PARKING</b><br />(free space)</td>
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
  </tr>
  <tr>
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
  </tr>
  <tr>
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
   <td class="bingocell"></td> 
  </tr>
 </table>

 </div></div> <!-- actual cell/row -->
 <div class="row">
  <div class="twelve columns">&nbsp;<div class="text-right"><small>v1.2</small></div></div>
 </div> <!-- row -->
</div>
</body>
</html>

